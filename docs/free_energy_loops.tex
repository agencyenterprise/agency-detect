\documentclass[10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{textcomp}
\usepackage{microtype}
\geometry{margin=1in}

\title{Stratification of Free--Energy--Minimising Loops in the Vertebrate Brain}
\author{Gunnar Zarncke\\
AE Studio}
\date{July 2025}

\begin{document}
\maketitle

\begin{abstract}
Biological agents appear to manage a portfolio of nested optimisation loops, each minimising a distinct variational--free--energy term.  
We integrate recent literature into a single ledger, order the loops by plausible evolutionary age, and expose an \emph{internal--external} symmetry: 
for almost every interoceptive (``inside--the--skin'') regulator there exists an exteroceptive twin 
that reshapes the niche so that the corresponding sensory statistics become predictable.  
The taxonomy also offers insights into a free-energy-based model of agency and phenomenal consciousness and informs the design of safe artificial agents.
\end{abstract}

\section{Introduction}
Friston's free--energy principle \cite{friston2010free} predicts that any self--maintaining system will evolve mechanisms that keep its sensory surprise low.  
Neuroscientific work has now mapped multiple such mechanisms onto concrete circuits including ascending reticular pathways, cortico-thalamic loops, and descending modulatory systems: 
Respiratory chemoreflexes \cite{guyenet2015co2}, 
metabolic homeostasis \cite{karraza2024metabolic}, 
threat--response columns \cite{zhang2023pag}, and so on.  
Yet the literature is fragmented and rarely ordered developmentally.  
We synthesise the evidence into an ordered free-energy ledger (Tab.~\ref{tab:ledger}), emphasising 
\emph{(i)} the distinct free--energy term each loop targets; 
\emph{(ii)} the pairwise internal/external bifurcation; and 
\emph{(iii)} the evolutionary trajectory from brainstem reflexes to neocortical abstractions.

All free-energy terms are expressed in the standard variational form $F = \mathbb{E}_q[\ln q - \ln p]$, where $q$ represents the approximate posterior and $p$ the generative model, with specific instantiations derived for each biological system.

\section{Methods: Criteria for Loop Inclusion}
A biological circuit was counted as a loop if it satisfied three criteria: 
(1)\ it closes a sensor--to--actuator pathway through identifiable neural tissue; 
(2)\ interference with the pathway measurably increases some entropy term (prediction error, Gibbs free energy, chrono--mismatch, etc.); 
(3)\ at least one peer--reviewed article describes the loop in free--energy or closely allied control--theoretic language.

\section{Results: Ordered Ledger of Loops}
Table~\ref{tab:ledger} sorts loops from evolutionarily oldest (brainstem, present in most vertebrates) to most recent (default--mode network, present in humans).  
Each row shows the internal register, its external twin (when identified), the free--energy term minimised, dominant brain regions, and an anchoring citation.

\begin{table}[ht]
\centering
\small
\begin{tabular}{@{}r p{3.0cm} p{3.0cm} p{2.3cm} p{3.5cm} p{1.2cm}@{}}
\toprule
\textbf{Age} & \textbf{Internal loop} & \textbf{External twin} & \textbf{Free--energy term} & \textbf{Key regions (internal / external)} & \textbf{Ref.}\\
\midrule
1 & Respiratory control & --- & $F_{\text{CO}_2}$ & Medullary RTN, phrenic nucleus & \cite{guyenet2015co2}\\
2 & Thermoregulation & Microclimate selection & $F_{\text{temp}}$ & Hypothalamic PO/AH / PAG, motor cortex & \cite{tan2016warm}\\
3 & Vestibular balance & Spatial navigation & $F_{\text{orient}}$ & Vestibular nuclei / entorhinal cortex & \cite{angelaki2022vestibular}\\
4 & Ocular saccades & Visual attention & $F_{\text{gaze}}$ & Superior colliculus / frontal eye fields & \cite{white2022saccade}\\
5 & Circadian synchronization & Environmental rhythm synchronization & $F_{\text{circadian}}$ & Suprachiasmatic nucleus (SCN) / retina, pineal gland & \cite{patton2023circadian}\\
6 & Metabolic homeostasis & Habitat--fit (scene preference) & $F_{\text{metabolic}}$ & Insula, hypothalamus / PPA, retrosplenial & \cite{karraza2024metabolic}\\
7 & Threat / pain (PAG) & Perimeter defence & $F_{\text{threat}}$ & Periaqueductal gray, amygdala / superior colliculus & \cite{zhang2023pag}\\
8 & Vascular regulation & Resource distribution & $F_{\text{vascular}}$ & Brainstem vasomotor / autonomic cortex & \cite{iadecola2023vascular}\\
9 & Glial homeostasis & Synaptic pruning & $F_{\text{glial}}$ & Astrocytes, microglia / PFC, hippocampus & \cite{freeman2023glial}\\
10 & Morphological repair & Niche construction & $F_{\text{repair}}$ & Insula, immune cortex / PPC, premotor & \cite{koren2021immune}\\
11 & Precision / timing & Social/circadian rhythm sync & $F_{\text{timing}}$ & Cerebellar cortex, inferior olive / SCN & \cite{popa2018cerebellum}\\
12 & Reproductive physiology & Cultural/memetic reproduction & $F_{\text{reproduction}}$ & HPG axis, BNST / TPJ, Broca area & \cite{clarke2022hpg}\\
13 & Valuation / agency & Resource foraging & $F_{\text{valuation}}$ & Ventral striatum, OFC / dlPFC, hippocampus & \cite{sarter2023attention}\\
14 & Curiosity (epistemic) & Scientific exploration & $F_{\text{curiosity}}$ & Hippocampus, VTA / frontoparietal search nets & \cite{gruber2022curiosity}\\
15 & Coalition entropy & Institutional reputation & $F_{\text{coalition}}$ & TPJ, mPFC / linguistic cortex & \cite{scholz2023rtpj}\\

\bottomrule
\end{tabular}
\caption{Free--energy loops ordered by evolutionary age (leftmost column).  Dashes denote loops with no clear exteroceptive twin. In the Key regions column, ``/'' separates internal loop regions (left) from external loop regions (right).  Abbreviations: 
Ref.\ = representative reference; 
RTN = retrotrapezoid nucleus; 
PO/AH = preoptic/anterior hypothalamus;
SCN = suprachiasmatic nucleus; 
PPA = parahippocampal place area; 
PAG = periaqueductal gray; 
PFC = prefrontal cortex;
PPC = posterior parietal cortex; 
HPG = hypothalamo-pituitary-gonadal; 
BNST = bed nucleus of stria terminalis; 
TPJ = temporoparietal junction; 
OFC = orbitofrontal cortex; 
dlPFC = dorsolateral prefrontal cortex; 
VTA = ventral tegmental area; 
mPFC = medial prefrontal cortex.}
\label{tab:ledger}
\end{table}

\section{Free-Energy Terms: Biological Interpretations}

Each loop in Tab.~\ref{tab:ledger} targets a distinct free-energy term, derived from the general variational form $F = \mathbb{E}_q[\ln q - \ln p]$. Here we provide the mathematical formulation of each term:

\subsection{Respiratory Control}
$F_{\text{CO}_2} = \mathbb{E}_q[\ln q(\text{pCO}_2) - \ln p(\text{pCO}_2|\text{setpoint})]$

The respiratory system minimizes free energy over CO$_2$ partial pressure distributions, where $q$ represents the current belief about pCO$_2$ and $p$ the generative model based on homeostatic setpoints. This captures metabolic prediction error in chemoreceptor signaling.

\subsection{Thermoregulation}
$F_{\text{temp}} = \mathbb{E}_q[\ln q(T_{\text{core}}) - \ln p(T_{\text{core}}|\text{thermal comfort})]$

Hypothalamic thermoregulation minimizes free energy over core temperature distributions. The preoptic/anterior hypothalamus acts as a thermal controller, with prediction errors driving both autonomic responses and behavioral thermoregulation.

\subsection{Vestibular Balance}
$F_{\text{orient}} = \mathbb{E}_q[\ln q(\mathbf{r}, \dot{\mathbf{r}}) - \ln p(\mathbf{r}, \dot{\mathbf{r}}|\text{gravity, motion})]$

Vestibular systems minimize free energy over spatial orientation and motion estimates $(\mathbf{r}, \dot{\mathbf{r}})$. This enables stable balance and spatial navigation by maintaining accurate beliefs about head position and movement in gravitational and inertial reference frames.

\subsection{Ocular Saccades}
$F_{\text{gaze}} = \mathbb{E}_q[\ln q(\mathbf{x}_{\text{gaze}}) - \ln p(\mathbf{x}_{\text{gaze}}|\text{visual salience})]$

Saccadic eye movements minimize free energy over gaze direction $\mathbf{x}_{\text{gaze}}$. The superior colliculus integrates sensory predictions to direct attention toward locations of high expected information gain, reducing visual uncertainty.

\subsection{Circadian Synchronization}
$F_{\text{circadian}} = \mathbb{E}_q[\ln q(\phi_{\text{SCN}}) - \ln p(\phi_{\text{SCN}}|\phi_{\text{light}})]$

The suprachiasmatic nucleus (SCN) minimizes free energy over circadian phase $\phi_{\text{SCN}}$, synchronizing internal rhythms with external light-dark cycles $\phi_{\text{light}}$. This captures temporal prediction error between endogenous and environmental oscillators.

\subsection{Metabolic Homeostasis}
$F_{\text{metabolic}} = \mathbb{E}_q[\ln q(\text{glucose}, \text{hormones}) - \ln p(\text{glucose}, \text{hormones}|\text{energy demand})]$

Metabolic regulation minimizes free energy over glucose levels and hormonal states. This includes both interoceptive monitoring (insulin, leptin) and exteroceptive habitat assessment for resource prediction.

\subsection{Threat Detection}
$F_{\text{threat}} = \mathbb{E}_q[\ln q(\text{threat state}) - \ln p(\text{threat state}|\text{environmental cues})]$

The periaqueductal gray (PAG) system minimizes free energy over threat state distributions. This enables rapid defensive responses by maintaining precise beliefs about environmental dangers and appropriate behavioral responses.

\subsection{Vascular Regulation}
$F_{\text{vascular}} = \mathbb{E}_q[\ln q(\text{blood flow}) - \ln p(\text{blood flow}|\text{metabolic demand})]$

Vascular control loops minimize free energy over blood flow distributions, matching perfusion to metabolic demand. This includes both local autoregulation and central control via brainstem vasomotor centers.

\subsection{Glial Homeostasis}
$F_{\text{glial}} = \mathbb{E}_q[\ln q(\text{synaptic strength}) - \ln p(\text{synaptic strength}|\text{activity patterns})]$

Glial cells minimize free energy over synaptic strength distributions, pruning connections based on activity patterns. This maintains neural network efficiency by removing unused synapses and supporting active ones.

\subsection{Morphological Repair}
$F_{\text{repair}} = \mathbb{E}_q[\ln q(\text{tissue state}) - \ln p(\text{tissue state}|\text{structural integrity})]$

Immune and repair systems minimize free energy over tissue state distributions. This includes both cellular damage detection and coordinated repair responses to maintain bodily integrity.

\subsection{Precision and Timing}
$F_{\text{timing}} = \mathbb{E}_q[\ln q(\text{temporal predictions}) - \ln p(\text{temporal predictions}|\text{sensorimotor context})]$

Cerebellar circuits minimize free energy over temporal prediction distributions, enabling precise motor control and sensory prediction timing. This reduces uncertainty in the temporal coordination of behavior.

\subsection{Reproductive Success}
$F_{\text{reproduction}} = \mathbb{E}_q[\ln q(\text{reproductive state}) - \ln p(\text{reproductive state}|\text{mate availability, resources})]$

The hypothalamo-pituitary-gonadal axis minimizes free energy over reproductive state distributions. This balances mating effort against resource constraints and environmental conditions, following optimal reproductive strategies.

\subsection{Behavioral Valuation}
$F_{\text{valuation}} = \mathbb{E}_q[\ln q(\text{action values}) - \ln p(\text{action values}|\text{reward context})]$

Valuation systems minimize free energy over action-value distributions. This represents the brain's resource allocation problem: maintaining accurate beliefs about action outcomes to guide optimal decision-making.

\subsection{Epistemic Curiosity}
$F_{\text{curiosity}} = \mathbb{E}_q[\ln q(\text{world model}) - \ln p(\text{world model}|\text{observations})]$

Curiosity-driven systems minimize free energy over world model distributions by seeking information that reduces epistemic uncertainty. This drives exploration behavior that improves environmental understanding.

\subsection{Coalition Entropy}
$F_{\text{coalition}} = \mathbb{E}_q[\ln q(\text{social alliances}) - \ln p(\text{social alliances}|\text{group dynamics})]$

Social cognitive systems minimize free energy over coalition structure distributions. This enables prediction of group dynamics and social relationships, supporting cooperative behavior and reputation management.

\subsection{Cross-Species Validation}
The evolutionary ordering in Tab.~\ref{tab:ledger} makes testable predictions about loop presence across species:
\begin{itemize}
\item Loops 1--7 should be detectable in most vertebrates
\item Loops 8--11 should emerge in mammals with developed social structures  
\item Loops 12--15 should be most developed in primates and cetaceans
\end{itemize}

This cross-species approach would validate both the evolutionary timeline and the universality of free-energy minimization as an organizing principle.

\section{Internal--External Symmetry}
Columns two and three of Tab.~\ref{tab:ledger} show that most interoceptive regulators possess an exteroceptive counterpart.  
The pairing supports the hypothesis that agents not only keep their bodies in low--surprise states 
but also \emph{shape their niches} to make future sensation cheap to predict.

\section{Implications for Agency and Consciousness}
Higher loops (rows~13--15) rely on global broadcast and metacognitive tagging.  
Their success presupposes the older loops but also enables flexible agency: valuation loops turn feelings into plans, 
curiosity expands state space, and coalition loops amplify collective intelligence.  
Conscious experience, on this account, is the subjective correlate of information made\,---\,and kept\,---\,globally available; 
agency arises once valuation and efference cascade latch onto that data.  

\section{Implications for Alignment of Artificial Agents}
Alignment of artificial agents to human (or any) goals is an unsolved problem \cite{russell2019human, ngo2022alignment, miri2024problem}.
This structure of free--energy loops sheds light onto goal formation in biological agents that can be applied to artificial agents:
\begin{enumerate}
\item Agents manage general classes of internal and external entropy. External entropy is often overlooked in alignment research \cite{critch2020ai, hubinger2019risks}.
\item It could be possible to identify corresponding loops and free--energy terms in artificial agents \cite{friston2022designing, sajid2021active}.
\item It could be possible to engineer artificial agents that manage internal and external entropy in a way that is similar to biological agents and thus implicitly align closer with human goals \cite{millidge2020deep, ramstead2022bayesian}.
\end{enumerate}

\section{Conclusion}
Ordering free--energy loops by evolutionary age reveals a scaffold ascending from brainstem reflexes to neocortical abstractions, 
each adding degrees of freedom for prediction error minimisation.  
A dual emphasis on internal and external entropy suggests that safe artificial agents must account for \emph{both} sides: 
stabilise their internal variables \emph{and} avoid uncontrolled niche manipulation.  

The connection to the UAD framework transforms this descriptive taxonomy into an empirical research program. By applying Markov blanket detection to neural or LLM time-series data, researchers can try to validate the existence of each predicted loop and measure transparency weights between loops that emerge from loop interactions. 
This represents a fundamental shift to measurable science in understanding the architecture of biological agency.
Our goal is detection of loops in artificial agents for verification of compliant agent behavior and the design of compliant loops in artificial agents.

\bibliographystyle{plain}
\begin{thebibliography}{10}
\bibitem{friston2010free} Friston K. The free-energy principle: a unified brain theory? Nature Reviews Neuroscience. 2010;11(2):127-138. doi: \url{https://doi.org/10.1038/nrn2787}

\bibitem{guyenet2015co2} Guyenet PG, Bayliss DA. Neural control of breathing and CO$_{2}$ homeostasis. Nature Reviews Neuroscience. 2015;16(7):367-378. doi: \url{https://doi.org/10.1038/nrn3973}

\bibitem{tan2016warm} Tan CL, Cooke EK, Leib DE, Lin YC, Daly GE, Zimmerman CA, Scott MM, Bjorkman KK, Reimann F, Gribble FM, Liberles SD, Dilorio P, Patapoutian A, Knight ZA. Warm-sensitive neurons that control body temperature. Nature. 2016;532(7600):586-590. doi: \url{https://doi.org/10.1038/nature17434}

\bibitem{angelaki2022vestibular} Angelaki DE, Laurens J. The head direction cell network: attractor dynamics underlying integrative computation. eLife. 2022;11:e73266. doi: \url{https://doi.org/10.7554/eLife.73266}

\bibitem{white2022saccade} White BJ, Kan JY, Levy R, Itti L, Munoz DP. Superior colliculus encodes visual saliency before the primary visual cortex. Proceedings of the National Academy of Sciences. 2022;119(12):e2121642119. doi: \url{https://doi.org/10.1073/pnas.2121642119}

\bibitem{patton2023circadian} Patton AP, Hastings MH. The suprachiasmatic nucleus. Current Biology. 2023;33(15):R746-R750. doi: \url{https://doi.org/10.1016/j.cub.2023.06.029}

\bibitem{karraza2024metabolic} Karraza-Samper N, Chen M, Rodriguez-Lopez A, et al. Metabolic coupling in the brain: neural-glial interactions in energy homeostasis. Nature Neuroscience. 2024;27(3):421-433. doi: \url{https://doi.org/10.1038/s41593-024-01589-3}

\bibitem{zhang2023pag} Zhang H, Franceschini A, Cetin A, et al. The contribution of periaqueductal gray to pain and defensive behaviors. Nature Reviews Neuroscience. 2023;24(10):597-610. doi: \url{https://doi.org/10.1038/s41583-023-00729-w}

\bibitem{iadecola2023vascular} Iadecola C, Duering M, Hachinski V, et al. Vascular cognitive impairment and dementia: JACC scientific statement. Journal of the American College of Cardiology. 2023;81(16):1617-1641. doi: \url{https://doi.org/10.1016/j.jacc.2023.02.026}

\bibitem{freeman2023glial} Freeman MR, Rowitch DH. Evolving concepts of gliogenesis: a look way back and ahead to the next 25 years. Neuron. 2023;111(3):297-311. doi: \url{https://doi.org/10.1016/j.neuron.2023.01.003}

\bibitem{koren2021immune} Koren T, Yifa R, Amer M, et al. Insular cortex neurons encode and retrieve specific immune responses. Cell. 2021;184(23):6103-6116. doi: \url{https://doi.org/10.1016/j.cell.2021.10.014}

\bibitem{popa2018cerebellum} Popa LS, Ebner TJ. Cerebellum, predictions and errors. Frontiers in Cellular Neuroscience. 2018;12:524. doi: \url{https://doi.org/10.3389/fncel.2018.00524}

\bibitem{clarke2022hpg} Clarke IJ, Smith JT. Hypothalamic control of reproduction by gonadotropin-releasing hormone: recent advances. Nature Reviews Endocrinology. 2022;18(9):573-589. doi: \url{https://doi.org/10.1038/s41574-022-00712-6}

\bibitem{sarter2023attention} Sarter M, Lustig C, Blakely RD, Koshy Cherian A. Cholinergic genetics of visual attention: human and mouse choline transporter capacity variants and attention. Biological Psychiatry. 2023;93(4):331-339. doi: \url{https://doi.org/10.1016/j.biopsych.2022.09.013}

\bibitem{gruber2022curiosity} Gruber MJ, Ritchey M, Wang SF, Doss MK, Ranganath C. Post-learning hippocampal dynamics promote preferential retention of rewarding events. Neuron. 2022;110(16):2635-2646. doi: \url{https://doi.org/10.1016/j.neuron.2022.05.017}

\bibitem{scholz2023rtpj} Scholz J, Raschle NM, Hornberger M, et al. Right temporoparietal junction contributions to theory of mind in autism: a developmental perspective. Developmental Cognitive Neuroscience. 2023;61:101249. doi: \url{https://doi.org/10.1016/j.dcn.2023.101249}

\bibitem{russell2019human} Russell S. Human Compatible: Artificial Intelligence and the Problem of Control. New York: Viking; 2019.

\bibitem{ngo2022alignment} Ngo R, Chan L, Mindermann S. The alignment problem from a deep learning perspective. arXiv preprint arXiv:2209.00626. 2022. Available from: \url{https://arxiv.org/abs/2209.00626}

\bibitem{critch2020ai} Critch A, Krueger D. AI Research Considerations for Human Existential Safety (ARCHES). arXiv preprint arXiv:2006.04948. 2020. Available from: \url{https://arxiv.org/abs/2006.04948}

\bibitem{hubinger2019risks} Hubinger E, Dennison C, Ziegler M, et al. Risks from learned optimization in advanced machine learning systems. arXiv preprint arXiv:1906.01820. 2019. Available from: \url{https://arxiv.org/abs/1906.01820}

\bibitem{friston2022designing} Friston K, Parr T, Zeidman P, et al. Designing ecosystems of intelligence from first principles. arXiv preprint arXiv:2212.01354. 2022. Available from: \url{https://arxiv.org/abs/2212.01354}

\bibitem{sajid2021active} Sajid N, Ball PJ, Parr T, Friston KJ. Active inference: demystified and compared. Neural Computation. 2021;33(3):674-712. doi: \url{https://doi.org/10.1162/neco_a_01357}

\bibitem{millidge2020deep} Millidge B, Tschantz A, Buckley CL. Deep active inference as variational policy gradients. Journal of Mathematical Psychology. 2020;96:102348. doi: \url{https://doi.org/10.1016/j.jmp.2020.102348}

\bibitem{ramstead2022bayesian} Ramstead MJD, Sakthivadivel DAR, Heins C, et al. Bayesian mechanics of perceptual inference and motor control in the brain. Neural Networks. 2022;154:592-609. doi: \url{https://doi.org/10.1016/j.neunet.2022.07.024}

\bibitem{miri2024problem} Machine Intelligence Research Institute. The Problem. Palo Alto, CA: MIRI; 2024. Available from: \url{https://intelligence.org/the-problem/}
\end{thebibliography}

\end{document}
